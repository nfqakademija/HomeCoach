{% extends "::base2.html.twig" %}
{% block title %}
    Home Coach
{% endblock %}
{% block content %}
    <section id="home" class="parallax-section">
        <div class="container">
            <div class="row">
                <div class="col-md-12 col-sm-12">
                    <h1 class="home wow fadeInDown"> HOME <span class="homeSpan">COACH</span></h1>
                    {% if app.user is not null %}
                        <a href="{{ path('app.createWorkout') }}" class="btn btn-default smoothScroll wow fadeInUp" data-wow-delay="0.6s">SUKURTI PROGRAMĄ</a>
                    {% else %}
                        <a href="/login" class="btn btn-default smoothScroll wow fadeInUp" data-wow-delay="0.4s">PRISIJUNGTI</a>
                    {% endif %}
                    <a href="#mainSection" class="btn btn-default smoothScroll wow fadeInUp" data-wow-delay="0.6s">RODYTI PROGRAMAS</a>
                    {% if app.user and app.user.activeworkout is not null %}
                        <a href="#activeWorkout" class="btn btn-default smoothScroll wow fadeInUp" data-wow-delay="0.7s"> JŪSŲ AKTYVI PROGRAMA </a>
                    {% endif %}
                </div>
            </div>
        </div>
    </section>
    {% if app.user and app.user.activeworkout is not null %}
        <div class="row" id="activeWorkout">
            <div class="box col-md-4">
                <h2 style="font-family: Oswald"><a href="workouts/{{ app.user.activeworkout.id }}"> {{ app.user.activeworkout.title }}</a> </h2>
                <p> Autorius: <a href="showProfile/{{ app.user.activeworkout.creator.id }}"> {{ app.user.activeworkout.creator.username }}</a></p>
                <p class="description">{{ app.user.activeworkout.description[:150] }}</p>
                <a href="workouts/{{ app.user.activeworkout.id }}" class="button">Daugiau</a>
            </div>
            <div class="col-md-8">
                <ul class="nav nav-pills radios">
                    {% set days = ["Pirm.", "Antr.", "Treč.", "Ketv.", "Penkt.", "Šešt.", "Sekm."] %}
                    {% set activeSet=false %}
                    {% set first=null %}
                    {% for i in 0..6 %}
                        <li {% if activeSet==false and app.user.activeworkout.schedule[i] != null %} class="active" {% set activeSet=true %} {% set first=i %}{% endif %}><a {% if app.user.activeworkout.schedule[i] == null %} class="disabled" {% endif %}data-toggle="pill" href="#day{{ i+1 }}">{{ days[i] }}</a></li>
                    {% endfor %}
                </ul>
                <div class="tab-content" id="form_schedule">
                    {% for i in 0..6 %}
                        <div id="day{{ i+1 }}" class="tab-pane fade {% if i==first %} active in {% endif %}">
                            <p style="word-break: break-all; color:white;"> {{ app.user.activeworkout.schedule[i] }} </p>
                        </div>
                    {% endfor %}
                </div>
            </div>
        </div>
    {% endif %}
    <div class="container" id="mainSection">
        <div ng-app="workoutApp" ng-controller="workoutsController">

            <div style="margin-top:45px;">
                <input type="text" placeholder="Paieška" id="search" ng-change="searchInput(param)" ng-model="param.searchKey">

                <select id="selectBox"  ng-init="difficultySelected='all'" ng-model="diffucultySelected" ng-change="difficultyChange()">
                    <option ng-selected="true" value="all"> Visos </option>
                    <option value="5"> Labai sunki </option>
                    <option value="4"> Sunki </option>
                    <option value="3"> Vidutinė </option>
                    <option value="2"> Lengva </option>
                    <option value="1"> Labai lengva </option>
                </select>

                <input type="button" id="dateButton" value="Pagal data" ng-click="sortByDate()">  </input>
                <input type="button" id="ratingButton" value="Pagal reitinga" ng-click="sortByRatings()">  </input>
            </div>
            <div infinite-scroll='loadMore()' infinite-scroll-distance='1'>
                <div class="row no-collapse-1 noOverflow">
                    <section class="col-md-4" ng-repeat="workout in workouts">
                        <div class="box">
                            <h3><span ng-if="workout.rating" class="infoStar">{[{ workout.rating }]} &starf;</span></h3>
                            <h2 style="font-family: Oswald"><a href="workouts/{[{ workout.id }]}"> {[{ workout.title }]}</a> </h2>
                            <p> Autorius: <a href="showProfile/{[{ workout.creator_id }]}"> {[{ workout.username }]}</a></p>
                            <p> Sukurta <span am-time-ago="workout.data_created"></span></p>
                            <p class="description">{[{ workout.description | limitTo:100 }]}</p>
                            <a href="workouts/{[{ workout.id }]}" class="button">Daugiau</a>
                        </div>
                    </section>
                </div>
            </div>
            <p style="margin:200px; text-align: center;" ng-if="workouts.length==0">Neradome nei vienos programos</p>
        </div>
    </div>
    {% include "::inc/header.html.twig" %}
{% endblock %}